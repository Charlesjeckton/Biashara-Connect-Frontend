<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Buyer Registration | Biashara Connect</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>
</head>
<body>

<div class="container py-5">
    <div class="row justify-content-center">
        <div class="col-md-8 col-lg-6">
            <div class="card shadow-sm">
                <div class="card-header bg-success text-white text-center">
                    <h4 class="mb-0"><i class="fas fa-user-plus me-2"></i>Create Buyer Account</h4>
                </div>
                <div class="card-body">
                    <div id="alertContainer"></div>
                    <form id="buyerRegistrationForm" novalidate>
                        <div class="row g-3">
                            <!-- First Name -->
                            <div class="col-md-6">
                                <label class="form-label"><i class="fas fa-user me-1"></i>First Name</label>
                                <input type="text" name="first_name" class="form-control" placeholder="Enter your first name" required>
                            </div>

                            <!-- Last Name -->
                            <div class="col-md-6">
                                <label class="form-label"><i class="fas fa-user me-1"></i>Last Name</label>
                                <input type="text" name="last_name" class="form-control" placeholder="Enter your last name" required>
                            </div>

                            <!-- Email -->
                            <div class="col-12">
                                <label class="form-label"><i class="fas fa-envelope me-1"></i>Email Address</label>
                                <input type="email" name="email" class="form-control" placeholder="you@example.com" required>
                            </div>

                            <!-- Phone -->
                            <div class="col-12">
                                <label class="form-label"><i class="fas fa-phone me-1"></i>Phone Number</label>
                                <input type="tel" name="phone" class="form-control" placeholder="+254 7XX XXX XXX" required>
                            </div>

                            <!-- Password -->
                            <div class="col-md-6">
                                <label class="form-label"><i class="fas fa-lock me-1"></i>Password</label>
                                <input type="password" name="password" class="form-control" placeholder="Create a strong password" required>
                                <div class="form-text">At least 8 characters, letters & numbers</div>
                            </div>

                            <!-- Confirm Password -->
                            <div class="col-md-6">
                                <label class="form-label"><i class="fas fa-lock me-1"></i>Confirm Password</label>
                                <input type="password" name="confirm_password" class="form-control" placeholder="Confirm your password" required>
                            </div>

                            <!-- Location -->
                            <div class="col-12">
                                <label class="form-label"><i class="fas fa-map-marker-alt me-1"></i>Location</label>
                                <select name="location" class="form-select" required>
                                    <option value="" disabled selected>Select your city</option>
                                    <option value="Nairobi">Nairobi</option>
                                    <option value="Mombasa">Mombasa</option>
                                    <option value="Kisumu">Kisumu</option>
                                    <option value="Nakuru">Nakuru</option>
                                    <option value="Eldoret">Eldoret</option>
                                    <option value="Other">Other</option>
                                </select>
                            </div>

                            <!-- Terms -->
                            <div class="col-12">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" name="terms" id="buyerTerms" required>
                                    <label class="form-check-label" for="buyerTerms">
                                        I agree to the <a href="#" class="fw-bold">Terms & Conditions</a> and <a href="#" class="fw-bold">Privacy Policy</a>
                                    </label>
                                </div>
                            </div>

                            <!-- Submit -->
                            <div class="col-12 d-grid">
                                <button type="submit" class="btn btn-success">
                                    <i class="fas fa-user-check me-2"></i>Register as Buyer
                                </button>
                            </div>
                        </div>
                    </form>

                    <div class="text-center mt-3">
                        Already have an account? <a href="/login.html">Sign in here</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
const form = document.getElementById('buyerRegistrationForm');
const alertContainer = document.getElementById('alertContainer');

form.addEventListener('submit', async (e) => {
    e.preventDefault();
    alertContainer.innerHTML = '';

    const formData = {
        first_name: form.first_name.value,
        last_name: form.last_name.value,
        email: form.email.value,
        phone: form.phone.value,
        password: form.password.value,
        confirm_password: form.confirm_password.value,
        location: form.location.value
    };

    try {
        const res = await fetch('https://biashara-connect-backend.onrender.com/api/register/buyer/', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(formData)
        });

        const data = await res.json();

        if (!res.ok) {
            // Show validation errors
            let errorsHtml = '<div class="alert alert-danger"><ul>';
            for (const key in data) {
                errorsHtml += `<li>${key}: ${data[key]}</li>`;
            }
            errorsHtml += '</ul></div>';
            alertContainer.innerHTML = errorsHtml;
        } else {
            alertContainer.innerHTML = '<div class="alert alert-success">Registration successful! Redirecting to login...</div>';
            setTimeout(() => { window.location.href = '/login.html'; }, 2000);
        }
    } catch (error) {
        alertContainer.innerHTML = `<div class="alert alert-danger">Error: ${error.message}</div>`;
    }
});
</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
